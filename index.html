<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>üåü Aluche Slideshow Universal Tablet</title>
  <style>
    /* RESET UNIVERSAL */
    * { margin: 0; padding: 0; box-sizing: border-box; }
    html, body { 
      height: 100vh; overflow: hidden; 
      background: radial-gradient(circle at center, #0a0a2e 0%, #1a0033 100%);
      font-family: system-ui, -apple-system, sans-serif;
      touch-action: manipulation;
      -webkit-user-select: none; user-select: none;
    }
    
    /* SLIDESHOW CORE */
    #slideshow { position: fixed; inset: 0; }
    .foto { 
      position: absolute; inset: 0; width: 100%; height: 100%; 
      object-fit: cover; opacity: 0; 
      transition: opacity 1.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      loading: eager; decoding: async;
    }
    .foto.activa { opacity: 1; transform: scale(1.02); }
    
    /* UI UNIVERSAL */
    #info { 
      position: fixed; top: 20px; left: 20px; 
      background: rgba(0,122,255,0.92); backdrop-filter: blur(20px);
      color: white; padding: 12px 24px; border-radius: 25px; 
      font-size: clamp(14px, 3vw, 18px); z-index: 100;
      box-shadow: 0 8px 32px rgba(0,122,255,0.3);
    }
    #reloj { 
      position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%);
      background: rgba(0,0,0,0.85); backdrop-filter: blur(20px);
      color: #fff; padding: 20px 40px; border-radius: 40px; 
      font-size: clamp(24px, 6vw, 36px); font-weight: 700; z-index: 50;
      box-shadow: 0 10px 40px rgba(0,0,0,0.5);
    }
    
    /* CONFIG RESPONSIVE */
    #config { 
      position: fixed; top: 20px; right: 20px; 
      background: rgba(0,0,0,0.95); backdrop-filter: blur(20px);
      color: white; padding: 24px; border-radius: 25px; 
      font-size: clamp(14px, 3vw, 16px); z-index: 100;
      box-shadow: 0 12px 40px rgba(0,0,0,0.6);
      max-width: 280px;
      opacity: 0; transform: translateY(-20px); transition: all 0.3s ease;
    }
    #config.mostrar { opacity: 1; transform: translateY(0); }
    
    button { 
      background: linear-gradient(135deg, #007AFF, #005BB5); 
      color: white; border: none; padding: 12px 20px; border-radius: 12px; 
      font-size: clamp(14px, 3vw, 16px); cursor: pointer; margin: 6px 0;
      width: 100%; box-shadow: 0 4px 15px rgba(0,122,255,0.4);
      transition: all 0.2s; 
    }
    button:active { transform: scale(0.98); }
    input { 
      width: 100%; padding: 12px; border-radius: 12px; border: 2px #007AFF solid; 
      background: rgba(255,255,255,0.95); font-size: clamp(16px, 4vw, 18px); 
      text-align: center; margin: 6px 0;
    }
    
    /* TOUCH GESTURES */
    .swipe-hint { 
      position: fixed; bottom: 100px; left: 50%; transform: translateX(-50%);
      font-size: 24px; opacity: 0.7; z-index: 40; animation: swipe 2s infinite;
    }
    @keyframes swipe { 0%,100%{opacity:0.3} 50%{opacity:0.8; transform:translateX(-50%) translateY(10px)} }
    
    /* RESPONSIVE TABLET */
    @media (max-width: 1024px) and (min-width: 768px), (orientation: landscape) {
      .foto { object-position: center center !important; }
      #info { top: 15px; left: 15px; font-size: 16px; }
      #reloj { bottom: 20px; font-size: 28px; }
    }
    
    @media (max-width: 768px) {
      #info { top: 10px; left: 10px; right: 10px; text-align: center; }
      #config { top: 10px; right: 10px; left: 10px; max-width: none; }
      #reloj { bottom: 15px; font-size: 24px; padding: 15px 25px; }
    }
    
    @media (prefers-reduced-motion: reduce) {
      * { transition: none !important; animation: none !important; }
    }
  </style>
</head>
<body>
  <!-- SLIDESHOW -->
  <div id="slideshow">
    <div id="fotos-container"></div>
  </div>
  
  <!-- UI -->
  <div id="info">üñºÔ∏è Galer√≠a Madrid/Aluche ‚Ä¢ Universal Tablet</div>
  <div id="reloj">20:55</div>
  <div class="swipe-hint">üëÜ Swipe ‚Üê ‚Üí</div>
  
  <!-- CONFIG -->
  <div id="config">
    <div style="margin-bottom: 12px; font-weight: bold;">‚öôÔ∏è Configuraci√≥n</div>
    ‚è±Ô∏è Tiempo (seg): <input id="tiempo-input" type="number" value="10" min="3" max="30"><br>
    <button onclick="aplicarTiempo()">‚ñ∂ Aplicar</button>
    <button onclick="siguienteFoto()">‚è≠ Siguiente</button>
    <button onclick="toggleShuffle()">üîÄ Shuffle</button>
    <button onclick="toggleConfig()">‚úï Cerrar</button>
  </div>

  <script>
    // ===================== FOTOS CORS-FREE UNIVERSAL =====================
    const FOTOS_MADRID = [
      'https://images.unsplash.com/photo-1506905925346-21bda4d32df4?fit=crop&w=1920&h=1080', // Madrid noche
      'https://images.unsplash.com/photo-1543782249-3f2e0f3035f9?fit=crop&w=1920&h=1080', // Aluche
      'https://images.unsplash.com/photo-1600585154340-be6161a56a0c?fit=crop&w=1920&h=1080', // Skyline
      'https://images.unsplash.com/photo-1488521787991-ed7bbaae773c?fit=crop&w=1920&h=1080', // Plaza
      'https://images.unsplash.com/photo-1575453572600-50b489e525a9?fit=crop&w=1920&h=1080', // Luces
      'https://images.unsplash.com/photo-1511299330437-e21bb73f4d95?fit=crop&w=1920&h=1080', // Retiro
      'https://images.unsplash.com/photo-1544620347-c4fd4a3d5957?fit=crop&w=1920&h=1080', // Gran Via
      'https://images.unsplash.com/photo-1564507592333-a0f60f4b504c?fit=crop&w=1920&h=1080'  // Cibeles
    ];
    
    let fotos = [...FOTOS_MADRID], indice = 0, tiempoFoto = 10000, intervalo;
    let shuffleMode = false;

    // ===================== SLIDESHOW =====================
    function iniciarSlideshow() {
      if (intervalo) clearInterval(intervalo);
      mostrarFoto();
      intervalo = setInterval(siguienteFoto, tiempoFoto);
    }

    function mostrarFoto() {
      const contenedor = document.getElementById('fotos-container');
      contenedor.innerHTML = '';
      
      const img = document.createElement('img');
      img.src = fotos[indice % fotos.length];
      img.className = 'foto activa';
      img.alt = 'Madrid/Aluche';
      img.loading = 'eager';
      
      img.addEventListener('load', () => {
        document.getElementById('info').textContent = `üñºÔ∏è ${indice + 1}/${fotos.length} ‚Ä¢ ${new Date().toLocaleTimeString('es-ES', {hour:'2-digit', minute:'2-digit'})}`;
      });
      
      img.onerror = () => {
        img.src = FOTOS_MADRID[0]; // Fallback seguro
      };
      
      contenedor.appendChild(img);
    }

    function siguienteFoto() {
      indice++;
      mostrarFoto();
    }

    function anteriorFoto() {
      indice = (indice - 1 + fotos.length) % fotos.length;
      mostrarFoto();
    }

    // ===================== TOUCH/SWIPE UNIVERSAL =====================
    let startX = 0, startY = 0;
    document.addEventListener('touchstart', e => {
      startX = e.touches[0].clientX;
      startY = e.touches[0].clientY;
    }, { passive: true });
    
    document.addEventListener('touchend', e => {
      if (!startX || !startY) return;
      const endX = e.changedTouches[0].clientX;
      const endY = e.changedTouches[0].clientY;
      const diffX = startX - endX;
      const diffY = Math.abs(startY - endY);
      
      if (Math.abs(diffX) > 50 && diffY < 100) { // Swipe horizontal
        if (diffX > 0) siguienteFoto(); else anteriorFoto();
      }
      startX = 0; startY = 0;
    }, { passive: true });

    // ===================== CONFIG =====================
    function aplicarTiempo() {
      const nuevo = parseInt(document.getElementById('tiempo-input').value) * 1000;
      if (nuevo >= 3000 && nuevo <= 30000) {
        tiempoFoto = nuevo;
        clearInterval(intervalo);
        setTimeout(iniciarSlideshow, 200);
      }
    }

    function toggleShuffle() {
      shuffleMode = !shuffleMode;
      if (shuffleMode) {
        fotos = shuffle([...FOTOS_MADRID]);
        document.getElementById('info').textContent += ' üîÄ SHUFFLE ON';
      } else {
        fotos = [...FOTOS_MADRID];
        document.getElementById('info').textContent = 'üñºÔ∏è Galer√≠a Madrid/Aluche';
      }
      indice = 0;
      mostrarFoto();
    }

    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }

    function toggleConfig() {
      const config = document.getElementById('config');
      config.classList.toggle('mostrar');
    }

    // ===================== CLICK/TAP =====================
    document.addEventListener('click', e => {
      if (e.clientX < window.innerWidth / 2) anteriorFoto();
      else siguienteFoto();
    });

    // ===================== RELOJ =====================
    function tick() {
      const ahora = new Date();
      document.getElementById('reloj').textContent = 
        ahora.toLocaleTimeString('es-ES', { hour: '2-digit', minute: '2-digit' });
    }

    // ===================== INIT =====================
    window.addEventListener('load', () => {
      document.getElementById('info').textContent = 'üöÄ Universal Tablet Ready ‚Ä¢ Swipe/Tap';
      iniciarSlideshow();
      tick();
      setInterval(tick, 1000);
      
      // Auto-ocultar config
      setTimeout(() => document.getElementById('config').classList.remove('mostrar'), 5000);
    });

    // ===================== PWA FEATURES =====================
    let deferredPrompt;
    window.addEventListener('beforeinstallprompt', (e) => {
      deferredPrompt = e;
    });
  </script>
</body>
</html>

