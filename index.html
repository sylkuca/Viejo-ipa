<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ðŸ“¸ Marco Digital</title>

<style>
*{margin:0;padding:0;box-sizing:border-box}
html,body{
  height:100%;
  background:#000;
  overflow:hidden;
  font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;
}

#slideshow{
  position:fixed;
  inset:0;
}

#foto{
  width:100%;
  height:100%;
  object-fit:cover;
  opacity:0;
  transition:opacity 1.2s ease-in-out;
}

#status{
  position:fixed;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%);
  background:rgba(0,0,0,.85);
  color:#0f0;
  padding:20px 28px;
  border-radius:14px;
  font-size:16px;
  z-index:10;
}
</style>
</head>

<body>

<div id="slideshow">
  <img id="foto" alt="foto">
</div>

<div id="status">Iniciandoâ€¦</div>

<script>
const TIEMPO_FOTO = 10000;
let fotos = [];
let indice = 0;
let timer = null;

async function iniciar() {
  const status = document.getElementById('status');

  try {
    status.textContent = 'Actualizando Ã¡lbumâ€¦';
    await fetch('drive_fotos.php', { cache: 'no-store' });

    status.textContent = 'Cargando fotosâ€¦';
    const r = await fetch('fotos.json', { cache: 'no-store' });
    fotos = await r.json();

    if (!Array.isArray(fotos) || fotos.length === 0) {
      throw new Error('Ãlbum vacÃ­o');
    }

    fotos.sort(() => Math.random() - 0.5);
    mostrar();
    timer = setInterval(mostrar, TIEMPO_FOTO);

    status.style.display = 'none';

  } catch (e) {
    status.textContent = 'âŒ Error cargando fotos';
    console.error(e);
  }
}

function mostrar() {
  const img = document.getElementById('foto');
  img.style.opacity = 0;

  setTimeout(() => {
    img.src = fotos[indice];
    indice = (indice + 1) % fotos.length;
    img.style.opacity = 1;
  }, 600);
}

window.addEventListener('load', iniciar);
</script>

</body>
</html>

